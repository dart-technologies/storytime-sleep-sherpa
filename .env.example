# ============================================
# Storytime: Sleep Sherpa - Environment Setup
# ============================================

# --------------------------------------------
# üì± Expo Client (EXPO_PUBLIC_*)
# --------------------------------------------
# These variables are bundled with your app. 
# They are required for both local development AND EAS builds.
# For EAS, upload these to the Expo Dashboard (Project Settings > Environment Variables).

# Google OAuth
EXPO_PUBLIC_GOOGLE_CLIENT_ID=your-google-client-id.apps.googleusercontent.com
EXPO_PUBLIC_GOOGLE_IOS_CLIENT_ID=your-ios-client-id.apps.googleusercontent.com

# Firebase Web Config
EXPO_PUBLIC_FIREBASE_API_KEY=your-firebase-api-key
EXPO_PUBLIC_FIREBASE_AUTH_DOMAIN=your-project.firebaseapp.com
EXPO_PUBLIC_FIREBASE_PROJECT_ID=your-project-id
EXPO_PUBLIC_FIREBASE_STORAGE_BUCKET=your-project.appspot.com
EXPO_PUBLIC_FIREBASE_MESSAGING_SENDER_ID=123456789012
EXPO_PUBLIC_FIREBASE_APP_ID=1:123456789012:web:abcdef123456

# Web Sharing (EAS Hosting)
# Base URL for the deployed Expo web app used for share links, e.g. https://storytime.expo.app
EXPO_PUBLIC_WEB_BASE_URL=
#
# Optional: separate share domain (recommended for rich link previews).
# If set, the app will generate share links on this domain instead of the Expo web domain.
# Configure this domain to serve per-story Open Graph tags (see Firebase Hosting rewrites to the `share` function in `firebase.json`).
# Example: https://your-project.web.app
EXPO_PUBLIC_SHARE_BASE_URL=

# iOS acquisition
# Used by the web share page to link viewers to the TestFlight install.
EXPO_PUBLIC_TESTFLIGHT_URL=https://testflight.apple.com/join/YOUR_CODE

# Debug (client)
# Controls client debug logging.
# - In dev builds, logging defaults to `latency` to keep console output focused.
# - In preview/production builds, logging defaults to `off`.
# Values:
# - `latency`: prints only FlowLogger latency steps (+ms) and END lines
# - `verbose` (or `true`): prints all debug logs (very noisy)
# - `off`: disables debug logging entirely
EXPO_PUBLIC_DEBUG=latency

# Audio (client, iOS)
# Tuning knobs for demo/screen recording audio capture.
# If you see app audio captured too quietly during screen recording, prefer:
# - no mixing with other apps (set to 0)
# - voice audio mode `spokenAudio` (avoids VoIP-style processing)
EXPO_PUBLIC_ELEVENLABS_ALLOW_MIXING_WITH_OTHERS=0
#
# iOS voice session audio mode used for LiveKit/ElevenLabs voice conversations.
# Allowed values: default | spokenAudio | voiceChat | videoChat
EXPO_PUBLIC_IOS_VOICE_AUDIO_MODE=spokenAudio
#
# iOS playback audio mode used after leaving voice sessions (and during story playback).
# Allowed values: default | spokenAudio
EXPO_PUBLIC_IOS_PLAYBACK_AUDIO_MODE=spokenAudio

# Audio debug logging (client)
# Optional: add targeted console logs for audio session + player state without enabling full `EXPO_PUBLIC_DEBUG=verbose`.
# Values: off | basic | verbose
EXPO_PUBLIC_AUDIO_DEBUG=off
# Sample interval for periodic player/volume snapshots while audio is playing (ms). Set to 0 to disable sampling.
EXPO_PUBLIC_AUDIO_DEBUG_SAMPLE_MS=1000

# Firestore (client)
# How long to wait for `setDoc()` before showing a "syncing in background" toast (ms).
# Leave blank to use the default (3500).
EXPO_PUBLIC_FIRESTORE_WRITE_TIMEOUT_MS=

# Testing / cost controls (client)
# Override the default story duration while debugging generation/narration (saves ElevenLabs credits).
# Allowed values: 15, 60, 300, 600. Leave blank to use the runtime default (`config/app.defaultStoryDurationSec`, fallback 60).
EXPO_PUBLIC_TEST_STORY_DURATION_SEC=
#
# Vision upload tuning (client)
# These values control how aggressively the app downsizes/compresses picked images before sending them to the `vision` endpoint.
# Smaller values can improve demo latency (less upload + faster model processing) at the cost of detail.
EXPO_PUBLIC_UPLOAD_IMAGE_MAX_DIM_PX=1024
EXPO_PUBLIC_UPLOAD_IMAGE_JPEG_COMPRESS=0.85
EXPO_PUBLIC_UPLOAD_IMAGE_MAX_BASE64_LENGTH=1500000
#
# Optional per-request Vertex model overrides (client)
# - If unset, the app does not send model IDs; Cloud Functions uses `VERTEX_AI_*` env defaults (and its own fallbacks).
# - Use this to experiment with other model IDs without redeploying functions.
EXPO_PUBLIC_VERTEX_TEXT_MODEL_OVERRIDE=
EXPO_PUBLIC_VERTEX_VISION_MODEL_OVERRIDE=
EXPO_PUBLIC_VERTEX_IMAGE_MODEL_OVERRIDE=

# Cloud Functions / Cloud Run URLs
# Most endpoints require a Firebase Auth ID token in `Authorization: Bearer <token>` (the app sends this automatically after sign-in).
# `sharedStory` is a public endpoint used for web share links.
# If you see `HTTP 401` with an HTML response, Cloud Run is likely enforcing IAM; redeploy functions with `invoker: 'public'` (see `functions/src/index.ts`).
#
# You must configure either Option A or Option B.
#
# Option A (recommended for Firebase Functions v2): set each env var to the full URL printed by `firebase deploy`.
# Required for core app flows:
EXPO_PUBLIC_CLOUD_FUNCTION_GENERATE=
EXPO_PUBLIC_CLOUD_FUNCTION_NARRATE=
EXPO_PUBLIC_CLOUD_FUNCTION_ELEVENLABS_TOKEN=
# Optional (only needed if you enable these features):
# - `VISION` is used for Gemini image analysis and uploads the selected image for use as cover art.
# - `ILLUSTRATE` is used to generate cover art when no image is uploaded.
#   If unset, the app will try to infer it from `EXPO_PUBLIC_CLOUD_FUNCTION_GENERATE`/`VISION` when those are full URLs (e.g. `generate-*.a.run.app` ‚Üí `illustrate-*.a.run.app`).
EXPO_PUBLIC_CLOUD_FUNCTION_VISION=
EXPO_PUBLIC_CLOUD_FUNCTION_INTAKE=
EXPO_PUBLIC_CLOUD_FUNCTION_ILLUSTRATE=
EXPO_PUBLIC_CLOUD_FUNCTION_FEATURED=
EXPO_PUBLIC_CLOUD_FUNCTION_SHARED_STORY=
#
# Option B (single base URL): set a base URL and keep endpoints as relative paths (or omit them to use defaults like `/generate`).
# Note: this must be a shared base (e.g. `https://us-central1-<project>.cloudfunctions.net`) and NOT a single `*.a.run.app` service URL.
# EXPO_PUBLIC_CLOUD_FUNCTIONS_URL=https://us-central1-your-project.cloudfunctions.net

# ElevenLabs Voice IDs (TTS / Latency Masks)
EXPO_PUBLIC_ELEVENLABS_VOICE_LUNA=nbk2esDn4RRk4cVDdoiE
EXPO_PUBLIC_ELEVENLABS_VOICE_KAI=KmnvDXRA0HU55Q0aqkPG
EXPO_PUBLIC_ELEVENLABS_VOICE_RIVER=TB3vNRzK8VurMejP889q
EXPO_PUBLIC_ELEVENLABS_VOICE_ECHO=Qggl4b0xRMiqOwhPtVWT
EXPO_PUBLIC_ELEVENLABS_VOICE_SAGE=nncOnHs8qpoJX0KnDisb

# Scripts (Node) use ELEVENLABS_VOICE_* by default. Keep these in sync with the EXPO_PUBLIC_* values above.
ELEVENLABS_VOICE_LUNA=nbk2esDn4RRk4cVDdoiE
ELEVENLABS_VOICE_KAI=KmnvDXRA0HU55Q0aqkPG
ELEVENLABS_VOICE_RIVER=TB3vNRzK8VurMejP889q
ELEVENLABS_VOICE_ECHO=Qggl4b0xRMiqOwhPtVWT
ELEVENLABS_VOICE_SAGE=nncOnHs8qpoJX0KnDisb

# ElevenLabs Agent IDs (Conversational AI)
EXPO_PUBLIC_ELEVENLABS_AGENT_LUNA=agent_id_luna
EXPO_PUBLIC_ELEVENLABS_AGENT_KAI=agent_id_kai
EXPO_PUBLIC_ELEVENLABS_AGENT_RIVER=agent_id_river
EXPO_PUBLIC_ELEVENLABS_AGENT_ECHO=agent_id_echo
EXPO_PUBLIC_ELEVENLABS_AGENT_SAGE=agent_id_sage

# --------------------------------------------
# ü§´ Server Secrets (Cloud Functions / Scripts Only)
# --------------------------------------------
# NEVER include these in your Expo app bundle.
# These are used by GCP during deployment of functions.

# Google Cloud
# Requires Vertex AI API enabled: `aiplatform.googleapis.com` (GCP Console ‚Üí APIs & Services).
GOOGLE_CLOUD_PROJECT_ID=your-project-id
VERTEX_AI_LOCATION=us-central1
# If a configured model returns 404 (Publisher Model not found), retry in `global` before falling back.
VERTEX_AI_TRY_GLOBAL_LOCATION=true
# Optional override. Useful with `VERTEX_AI_LOCATION=global` (set to `aiplatform.googleapis.com`), or when routing through a proxy.
VERTEX_AI_API_ENDPOINT=
# Optional model overrides (must exist in the chosen region). Defaults are stable and widely available.
# Example: `gcloud alpha ai model-garden models list --model-filter=gemini --full-resource-name`
VERTEX_AI_TEXT_MODEL=gemini-3-pro-preview
VERTEX_AI_VISION_MODEL=gemini-3-flash-preview
# Used for cover art generation (falls back to `gemini-2.5-flash-image` if unavailable).
VERTEX_AI_IMAGE_MODEL=gemini-3-pro-image-preview
# Note: some `gemini-3-*` preview models may appear in Model Garden but still return 404 unless your project is allowlisted.

# ElevenLabs Management (Functions only)
ELEVENLABS_API_KEY=your-elevenlabs-api-key
# Optional: override the default narration model (`eleven_multilingual_v2`).
ELEVENLABS_TTS_MODEL_ID=

# Web Share Analytics (Functions)
# Optional: GA4 Measurement ID used by the `share` HTML function (format: G-XXXXXXXXXX).
GA_MEASUREMENT_ID=

# --------------------------------------------
# üõ†Ô∏è Development & Variants
# --------------------------------------------

# Build Variant (development | preview | production)
# Controls Firebase plist switching in app.config.js (Set in eas.json)
APP_VARIANT=development

# EAS Build file secrets (native Firebase config files)
# These env vars should point to file paths on the build machine (EAS file secrets). See `app.config.js`.
GOOGLE_SERVICES_INFO_PLIST=
GOOGLE_SERVICES_JSON=

# Node Environment
NODE_ENV=development

# Debugging
DEBUG=true
